webpackJsonp([3],{"/uDR":function(e,t){},"3Lcb":function(e,t){},"6NjS":function(e,t){},byV4:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("mvHQ"),r=a.n(s),o={name:"newProgramme",components:{},props:["currentStep","curTaskid","taskName","taskType"],data:function(){return{column_num:0,taskid:"",paramList:"",testloading:!1,errText:"",checkDis:!1,dialogag:!1,dialogag2:!1,form:{taskName:this.taskName,datasetType:"1",name:"",datasetName:"",date1:"",date2:"",delivery:!1,type:[],resource:"",desc:"",datasetpath:"",sf:"",sfcs:{},graphcs:{}},rules:{ag:{},step1:{taskName:[{required:!0,message:this.$t("newProgramme.formplaceholder.noName"),trigger:"blur"}]},step2:{datasetType:[{required:!0,message:this.$t("newProgramme.formplaceholder.noSelect"),trigger:"blur"}]},step3:{},sfcs:{},graphcs:{}},formLabelWidth:"37%",datasetList:[],sfList:[],selected_graphList:[],sfcs:"",graphcs:""}},methods:{childHandler:function(e){var t=this;console.log(this.$parent),console.log(e),0==e?this.$refs.step1.validate(function(e){e&&t.setTaskName()}):1==e?this.$refs.step2.validate(function(e){e&&(t.column_num>50?t.$confirm(t.$t("newProgramme.message.dataNumConfirm",{num:t.column_num}),"",{confirmButtonText:t.$t("newProgramme.button.dialog.ok"),cancelButtonText:t.$t("newProgramme.button.dialog.cancel"),type:"warning"}).then(function(){t.$emit("updateStep",2)}).catch(function(){}):t.$emit("updateStep",2))}):2==e&&this.$refs.step3.validate(function(e){e&&t.$emit("updateStep",3)})},handleSelect:function(e,t){console.log(this.$route)},setsfcs:function(){var e=this;this.$refs.sfcs.validate(function(t){t&&(e.dialogag=!1)})},setgraphcs:function(){var e=this;this.$refs.graphcs.validate(function(t){t&&(e.dialogag2=!1)})},setTaskName:function(){var e=this,t={task_name:this.form.taskName,task_type:this.taskType};(this.taskid||this.curTaskid)&&(t.task_id=this.taskid),this.$http.post(this.URL.baseurl+"/add_task",t,{emulateJSON:!0}).then(function(t){t.body.task_id?(e.taskid=t.body.task_id,e.form.datasetpath=t.body.task_path,e.$message({message:e.$t("newProgramme.message.nameSaved"),type:"success"}),e.$emit("updateStep",1),console.log("200")):e.$message({message:t.body.data,type:"error"})},function(e){this.$message({message:"error",type:"error"})})},setDatasetInfo:function(){var e=this,t={task_id:this.taskid,name_path:2==this.form.datasetType?this.form.datasetName:this.form.datasetpath};this.$http.post(this.URL.baseurl+"/set_dataset_info",t,{emulateJSON:!0}).then(function(t){200==t.body.status?(e.setAlgorithmInfo(),console.log("200")):e.$message({message:t.body.data||"error",type:"error"})},function(e){this.$message({message:"error",type:"error"})})},setAlgorithmInfo:function(){for(var e=this,t=this.form.sfcs,a={},s=0;s<t.length;s++)a[t[s].name]=t[s].val;var o={task_id:this.taskid,selected_algorithm:this.form.sf,selected_parameters:r()(a)};this.taskType,this.$http.post(this.URL.baseurl+"/set_algorithm_info",o,{emulateJSON:!0}).then(function(t){200==t.body.status?(e.runTask(),console.log("200")):e.$message({message:t.body.data,type:"error"})},function(e){this.$message({message:"error",type:"error"})})},taskExecute:function(){this.setDatasetInfo()},runTask:function(){var e=this,t={task_id:this.taskid};this.$http.post(this.URL.baseurl+"/run_task",t,{emulateJSON:!0}).then(function(t){200==t.body.status_code?e.$emit("updateStep",4):e.$message({message:t.body.data||"error",type:"error"})},function(e){this.$message({message:"error",type:"error"})})},getDatasetList:function(){var e=this;this.$http.post(this.URL.baseurl+"/get_inline_dataset_names",{task_id:this.taskid},{emulateJSON:!0}).then(function(t){e.datasetList=t.body.inline_datasets,e.form.datasetName=t.body.selected_dataset})},getAlgorithmName:function(){var e=this;this.$http.post(this.URL.baseurl+"/get_algorithm_names",{task_id:this.taskid},{emulateJSON:!0}).then(function(t){var a=t.body;e.sfList=a.list,e.form.sf=a.val||a.default,e.getAlgorithmParameters()})},getAlgorithmParameters:function(){var e=this;if(1==this.taskType)return this.getSelectedGraphParameters(),!1;var t={task_id:this.taskid,selected_algorithm:this.form.sf};this.$http.post(this.URL.baseurl+"/get_algorithm_parameters",t,{emulateJSON:!0}).then(function(t){for(var a=t.body,s=[],r=[],o=0;o<a.length;o++)s.push({name:a[o].name,default:a[o].default,list:a[o].list}),r.push({name:a[o].name,val:a[o].val||a[o].default});e.sfcs=s,e.form.sfcs=r,e.$refs.step3.clearValidate()},function(e){this.sfcs={},this.form.sfcs={},this.$refs.step3.clearValidate(),this.$message({message:"error",type:"error"})})},getSelectedGraphParameters:function(){var e=this,t={task_id:this.taskid,selected_algorithm:this.form.sf};this.$http.post(this.URL.baseurl+"/get_algorithm_parameters",t,{emulateJSON:!0}).then(function(t){for(var a=t.body,s=[],r=[],o=0;o<a.length;o++)s.push({name:a[o].name,default:a[o].default,list:a[o].list}),r.push({name:a[o].name,val:a[o].val||a[o].default});e.sfcs=s,e.form.sfcs=r,e.$refs.step3.clearValidate()},function(e){this.sfcs={},this.form.sfcs={},this.$refs.step3.clearValidate(),this.$message({message:"error",type:"error"})})},testPath:function(e,t,a){var s=this;if(!e)return this.$refs.step2.validateField("datasetpath"),!1;if(1!=this.form.datasetType)return a(),!1;var r={path:this.form.datasetpath};console.log(this.form.datasetpath),this.testloading=!0,this.checkDis=!0,this.errText=this.$t("newProgramme.checking"),this.column_num=0,this.$http.post(this.URL.baseurl+"/check_dataset",r,{emulateJSON:!0}).then(function(e){e.body.column_num?(s.column_num=e.body.column_num,s.errText=s.$t("newProgramme.message.dataNum",{num:e.body.column_num}),a()):(s.errText="",a(new Error(e.body.data))),s.testloading=!1,s.checkDis=!1},function(e){a(new Error("err")),this.checkDis=!1,this.testloading=!1,this.errText="err"})},getDatasetPath:function(){var e=this,t={task_id:this.taskid};this.$http.post(this.URL.baseurl+"/get_edit_customize_dataset_path",t,{emulateJSON:!0}).then(function(t){e.form.datasetpath=t.body.customize_path},function(e){this.$message({message:data.body.data,type:"error"})})},getInlineBox:function(){var e=this,t={task_id:this.taskid};this.$http.post(this.URL.baseurl+"/get_builtin_data_checkbox",t,{emulateJSON:!0}).then(function(t){console.log(t.body.is_inline),t.body.is_inline?e.form.datasetType="2":e.form.datasetType="1"},function(e){this.$message({message:data.body.data,type:"error"})})}},created:function(){this.curTaskid&&0==this.currentStep&&(this.taskid=this.curTaskid,this.form.taskName=this.taskName,this.getInlineBox())},watch:{"form.datasetpath":{deep:!0,handler:function(e,t){t.length>0&&0==e.length&&(this.errText="")}},"form.datasetType":{deep:!0,handler:function(e,t){2==e?this.getDatasetList():this.curTaskid}},currentStep:{handler:function(e,t){1==e&&e<t&&this.getInlineBox(),2==e&&this.getAlgorithmName()}},taskName:{handler:function(e,t){this.form.taskName=e}},curTaskid:{handler:function(e,t){e?0==this.currentStep&&(this.taskid=e,this.getInlineBox()):this.taskid=""}}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-steps",{attrs:{active:e.currentStep,"align-center":""}},[a("el-step",{attrs:{title:e.$t("newProgramme.step[0].title"),description:e.$t("newProgramme.step[0].desc.type"+e.taskType)}}),e._v(" "),a("el-step",{attrs:{title:e.$t("newProgramme.step[1].title"),description:e.$t("newProgramme.step[1].desc.type"+e.taskType)}}),e._v(" "),a("el-step",{attrs:{title:e.$t("newProgramme.step[2].title"),description:e.$t("newProgramme.step[2].desc.type"+e.taskType)}}),e._v(" "),a("el-step",{attrs:{title:e.$t("newProgramme.step[3].title"),description:e.$t("newProgramme.step[3].desc")}})],1),e._v(" "),a("el-form",{directives:[{name:"show",rawName:"v-show",value:0==e.currentStep,expression:"currentStep==0"}],ref:"step1",staticClass:"step",attrs:{model:e.form,rules:e.rules.step1}},[a("el-form-item",{attrs:{label:e.$t("newProgramme.formLabelName.nameType"+e.taskType),"label-width":e.formLabelWidth,prop:"taskName"}},[a("el-input",{attrs:{placeholder:e.$t("newProgramme.formplaceholder.noName")},model:{value:e.form.taskName,callback:function(t){e.$set(e.form,"taskName",t)},expression:"form.taskName"}})],1)],1),e._v(" "),a("el-form",{directives:[{name:"show",rawName:"v-show",value:1==e.currentStep,expression:"currentStep==1"}],ref:"step2",staticClass:"step",attrs:{model:e.form,rules:e.rules.step2}},[2==e.taskType?a("el-form-item",{attrs:{label:e.$t("newProgramme.formLabelName.dataset"),"label-width":e.formLabelWidth,prop:"datasetType"}},[a("el-radio",{attrs:{label:"1"},model:{value:e.form.datasetType,callback:function(t){e.$set(e.form,"datasetType",t)},expression:"form.datasetType"}},[e._v(e._s(e.$t("newProgramme.datasetRadio[0]")))]),e._v(" "),a("el-radio",{attrs:{label:"2"},model:{value:e.form.datasetType,callback:function(t){e.$set(e.form,"datasetType",t)},expression:"form.datasetType"}},[e._v(e._s(e.$t("newProgramme.datasetRadio[1]")))])],1):e._e(),e._v(" "),1==e.taskType?a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.form.datasetType,expression:"form.datasetType==1"}],attrs:{label:e.$t("newProgramme.formLabelName.dir"),"label-width":e.formLabelWidth,prop:"datasetpath",rules:[{required:!0,message:e.$t("newProgramme.formplaceholder.noDir"),trigger:"blur"}]}},[a("el-input",{attrs:{placeholder:e.$t("newProgramme.formplaceholder.noDir")},model:{value:e.form.datasetpath,callback:function(t){e.$set(e.form,"datasetpath",t)},expression:"form.datasetpath"}}),e._v(" "),a("div",{staticClass:"sub-title",domProps:{textContent:e._s(e.errText)}})],1):e._e(),e._v(" "),2==e.taskType?a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.form.datasetType,expression:"form.datasetType==1"}],attrs:{label:e.$t("newProgramme.formLabelName.userDataset"),"label-width":e.formLabelWidth,prop:"datasetpath",rules:[{required:1==e.form.datasetType,message:e.$t("newProgramme.formplaceholder.noUserDataset"),trigger:"blur"},{validator:e.testPath,trigger:"blur"}]}},[a("el-input",{attrs:{placeholder:e.$t("newProgramme.formplaceholder.noContent")},model:{value:e.form.datasetpath,callback:function(t){e.$set(e.form,"datasetpath",t)},expression:"form.datasetpath"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search",loading:e.testloading,disabled:e.checkDis},on:{click:function(t){return e.testPath()}},slot:"append"},[e._v(e._s(e.$t("newProgramme.button.check")))])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.form.datasetpath.length,expression:"form.datasetpath.length"}],staticClass:"sub-title",domProps:{textContent:e._s(e.errText)}})],1):e._e(),e._v(" "),2==e.taskType?a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2==e.form.datasetType,expression:"form.datasetType==2"}],attrs:{label:e.$t("newProgramme.formLabelName.innerDataset"),"label-width":e.formLabelWidth,prop:"datasetName",rules:{required:2==e.form.datasetType,message:e.$t("newProgramme.formplaceholder.noInnerDataset"),trigger:"blur"}}},[a("el-select",{attrs:{placeholder:e.$t("newProgramme.formplaceholder.noInnerDataset")},model:{value:e.form.datasetName,callback:function(t){e.$set(e.form,"datasetName",t)},expression:"form.datasetName"}},e._l(e.datasetList,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1):e._e()],1),e._v(" "),a("el-form",{directives:[{name:"show",rawName:"v-show",value:2==e.currentStep,expression:"currentStep==2"}],ref:"step3",staticClass:"step",attrs:{model:e.form,rules:e.rules.step3}},[a("el-form-item",{attrs:{label:1==e.taskType?e.$t("newProgramme.formLabelName.sample"):e.$t("newProgramme.formLabelName.selectAlgorithm"),"label-width":e.formLabelWidth,prop:"sf",rules:{required:!0,message:e.$t("newProgramme.formplaceholder.noSelect"),trigger:"blur"}}},[a("el-col",{attrs:{span:16}},[a("el-form-item",{attrs:{prop:"sf"}},[a("el-select",{attrs:{placeholder:e.$t("newProgramme.formplaceholder.noSelect")},on:{change:e.getAlgorithmParameters},model:{value:e.form.sf,callback:function(t){e.$set(e.form,"sf",t)},expression:"form.sf"}},e._l(e.sfList,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:10}},[2==e.taskType&&e.sfcs.length>0?a("el-button",{staticStyle:{"margin-top":"10px"},attrs:{type:"primary"},on:{click:function(t){e.dialogag=!0}}},[e._v(e._s(e.$t("newProgramme.button.configPara")))]):e._e()],1)],1),e._v(" "),1==e.taskType?a("el-form-item",{attrs:{label:"","label-width":e.formLabelWidth}},[a("el-col",{attrs:{span:8}},[e.sfcs.length>0?a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogag=!0}}},[e._v(e._s(e.$t("newProgramme.button.configPara")))]):e._e()],1)],1):e._e()],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:3==e.currentStep,expression:"currentStep==3"}],staticClass:"step"},[a("div",[a("el-divider",{attrs:{"content-position":"left"}},[e._v(e._s(e.$t("newProgramme.previewName.type"+e.taskType+".showName")))]),e._v(" "),a("P",[e._v(e._s(e.form.taskName||"--"))])],1),e._v(" "),a("div",[a("el-divider",{attrs:{"content-position":"left"}},[e._v(e._s(e.$t("newProgramme.previewName.type"+e.taskType+".dir")))]),e._v(" "),a("P",{directives:[{name:"show",rawName:"v-show",value:1==e.form.datasetType,expression:"form.datasetType==1"}]},[e._v(e._s(e.form.datasetpath||"--"))]),e._v(" "),a("P",{directives:[{name:"show",rawName:"v-show",value:2==e.form.datasetType,expression:"form.datasetType==2"}]},[e._v(e._s(e.form.datasetName||"--"))])],1),e._v(" "),a("div",[a("el-divider",{attrs:{"content-position":"left"}},[e._v(e._s(e.$t("newProgramme.previewName.type"+e.taskType+".select")))]),e._v(" "),a("P",[e._v(e._s(e.form.sf||"--"))])],1),e._v(" "),a("div",[a("el-divider",{attrs:{"content-position":"left"}},[e._v(e._s(e.$t("newProgramme.previewName.parameters")))]),e._v(" "),a("div",e._l(e.form.sfcs,function(t,s){return a("el-tag",{key:s,staticStyle:{margin:"0 10px 10px 0"},attrs:{effect:s%2?"plain":"light"}},[e._v(e._s(t.name+" : "+(t.val||"--")))])}),1),e._v(" "),a("el-card",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v(e._s(e.$t("newProgramme.previewName.parameters")))])]),e._v(" "),e._l(e.form.sfcs,function(t,s){return a("el-tag",{key:s,staticStyle:{margin:"0 10px 10px"},attrs:{effect:s%2?"plain":"light"}},[e._v(e._s(t.name+" : "+(t.val||"--")))])})],2)],1)]),e._v(" "),a("el-dialog",{attrs:{title:e.$t("newProgramme.dialogTitle.configPara"),width:"82%",visible:e.dialogag,"close-on-click-modal":!1,"destroy-on-close":!0,"append-to-body":""},on:{"update:visible":function(t){e.dialogag=t}}},[a("div",[a("el-form",{ref:"sfcs",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.form,rules:e.rules.sfcs,"label-width":"250px"}},e._l(e.sfcs,function(t,s){return a("el-form-item",{key:s,attrs:{label:t.name,prop:"sfcs["+s+"]",rules:{required:!(null==t.default),message:e.$t("newProgramme.formplaceholder.noEnterPara"),trigger:"blur"}}},[0==t.list.length?a("el-input",{attrs:{placeholder:null==t.default?"":e.$t("newProgramme.formplaceholder.noEnterPara")},model:{value:e.form.sfcs[s].val,callback:function(t){e.$set(e.form.sfcs[s],"val",t)},expression:"form.sfcs[key].val"}}):e._e(),e._v(" "),t.list.length>0?a("el-select",{staticStyle:{width:"202px"},attrs:{placeholder:null==t.default?"":e.$t("newProgramme.formplaceholder.noSelectPara")},model:{value:e.form.sfcs[s].val,callback:function(t){e.$set(e.form.sfcs[s],"val",t)},expression:"form.sfcs[key].val"}},e._l(t.list,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1):e._e()],1)}),1),e._v(" "),a("el-form",{ref:"ag",staticClass:"step",attrs:{model:e.form,rules:e.rules.ag}})],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.setsfcs}},[e._v(e._s(e.$t("newProgramme.button.dialog.complete")))]),e._v(" "),a("el-button",{on:{click:function(t){e.dialogag=!1}}},[e._v(e._s(e.$t("newProgramme.button.dialog.cancel")))])],1)])],1)},staticRenderFns:[]};var l={name:"CastleBoard",components:{newProgramme:a("VU/8")(o,i,!1,function(e){a("3Lcb"),a("/uDR")},"data-v-4c1038b4",null).exports},data:function(){return{a:"",search:"",curTaskid:"",taskName:"",taskType:"",isNew:"",multipleSelection:[],isTimer:!0,currentStep:0,form:{type:"1"},rules:{setType:{type:[{required:!0,message:this.$t("programme.placeholder.noSelect"),trigger:"blur"}]}},form01:{data_name:"",data_description:"",data_path:"",generating_operator:"",generating_parameters:{}},rules01:{data_name:[{required:!0,message:this.$t("programme.placeholder.nosdname"),trigger:"blur"},{pattern:/^[^:*?"<>|\/\\]+$/,message:this.$t("programme.placeholder.sdNameErr"),trigger:"blur"}],data_description:[{required:!0,message:this.$t("programme.placeholder.nodesc"),trigger:"blur"}],generating_operator:[{required:!0,message:this.$t("programme.placeholder.noselectOperator"),trigger:"blur"}]},tableData:[],dialogFormVisible:!1,dialogSetTypeVisible:!1,dialogUploadConfigVisible:!1,fileList:[],upNum:0,doneS:0,doneF:0}},methods:{submitUpload:function(){if(this.upNum&&this.doneS+this.doneF!==this.upNum)return!1;this.upNum=this.fileList.length,this.doneS=0,this.doneF=0,this.$refs.upload.submit()},bb:function(){this.fileList=[],this.upNum=0,this.dialogUploadConfigVisible=!1},cc:function(){document.getElementById("main").click()},aa:function(){this.$refs.upload.clearFiles(),this.upNum=0},handleRemove:function(e,t){if(this.fileList=t,0==t.length)return this.upNum=0,this.dialogUploadConfigVisible=!1,""},handlePreview:function(e){},handleChange:function(e,t){if(this.dialogUploadConfigVisible=!0,console.log(e),console.log(t),"ready"==e.status)return this.fileList=t,"";e.response&&200==e.response.status?(this.$message({message:e.name+" : "+e.response.data||"Success",type:"success"}),this.getTaskList(!0),this.doneS+=1,this.fileList=this.fileList.filter(function(e){return"success"!==e.status})):(e.response&&403==e.response.status?this.$message({message:e.name+" : "+e.response.data||"Error",type:"error"}):this.$message({message:e.name+" : Error",type:"error"}),e.status="ready",e.response=void 0,this.fileList=t,this.doneF+=1)},format:function(e,t){return 100*e>0?function(){return 100*e+"%"}:null==e?function(){return"0%"}:function(){return"Failed"}},percentage:function(e){return 100*e>0?100*e:null==e?0:100},setType:function(){this.dialogSetTypeVisible=!0},handleProgress:function(e,t,a){},handleSuccess:function(e,t,a){return""},handleError:function(e,t,a){return a.push(t),""},openSetdialog:function(){var e=this;this.$refs.setType.validate(function(t){t&&(e.dialogSetTypeVisible=!1,e.newTask())})},newTask:function(){this.dialogFormVisible=!0,this.isNew=!0,this.taskType=this.form.type,this.curTaskid="",this.taskName="",this.currentStep=0},editTask:function(e,t,a){this.dialogFormVisible=!0,this.isNew=!1,this.taskType=t.task_type,this.curTaskid=t.task_id,this.taskName=t.task_name,this.currentStep=0},nextStep:function(){this.$refs.stepBlock.childHandler(this.currentStep)},updateStep:function(e){4==e&&(this.dialogFormVisible=!1,this.getTaskList(!0)),this.currentStep=e},executeStep:function(){this.$refs.stepBlock.taskExecute()},toggleSelection:function(){this.$refs.multipleTable.clearSelection()},deleteTask:function(e){var t=this;if(console.log(this.multipleSelection),!this.multipleSelection.length)return!1;this.$http.post(this.URL.baseurl+"/delete_tasks",{task_id:r()(this.multipleSelection)},{emulateJSON:!0}).then(function(e){200==e.body.status?(t.getTaskList(!0),t.$message({message:e.body.data,type:"success"}),t.toggleSelection()):t.$message({message:e.body.data,type:"error"})},function(e){this.$message({message:"err",type:"error"})})},getTaskList:function(e){var t=this;this.$http.get(this.URL.baseurl+"/get_task_list").then(function(a){t.tableData=a.body;var s=t.tableData.filter(function(e){return!e.task_status||1*e.task_status<1}).length;if(!e&&s){var r=3;t.isTimer&&setTimeout(t.getTaskList,1e3*r)}else e&&s&&!t.isTimer&&(t.isTimer=!0,setTimeout(t.getTaskList,1e3*r));s||(t.isTimer=!1)},function(e){this.$message({message:this.$t("programme.message.networkErr"),type:"error"})})},showDetail:function(e,t,a){1==t.task_type?this.$router.push({path:"/detail",query:{id:t.task_id,name:t.task_name}}):this.$router.push({path:"/detail2",query:{id:t.task_id,name:t.task_name}})},handleSelectionChange:function(e){this.multipleSelection=[];for(var t=0;t<e.length;t++)this.multipleSelection.push(e[t].task_id)},downloader:function(e,t){var a=document.createElement("form");a.action=this.URL.baseurl+"/download_file",a.method="post",a.target="_black",a.style.display="none";var s=document.createElement("textarea");s.name="task_id",s.value=t.task_id,a.appendChild(s),document.body.appendChild(a),a.submit(),a.parentNode.removeChild(a)},exportTask:function(e,t){var a=document.createElement("form");a.action=this.URL.baseurl+"/export_task",a.method="post",a.target="_black",a.style.display="none";var s=document.createElement("textarea");s.name="task_id",s.value=t.task_id,a.appendChild(s),document.body.appendChild(a),a.submit(),a.parentNode.removeChild(a)}},watch:{dialogUploadConfigVisible:{handler:function(e,t){}},doneS:{handler:function(e,t){0!=this.upNum&&this.doneS&&this.doneS==this.upNum&&(this.dialogUploadConfigVisible=!1)}},dialogFormVisible:{handler:function(e,t){e||(this.curTaskid="",this.taskName="",this.currentStep=-1,this.getTaskList(!0))}}},created:function(){this.isTimer=!0,this.getTaskList()},activated:function(){this.isTimer||(this.isTimer=!0,this.getTaskList())},deactivated:function(){this.isTimer=!1}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:e.$t("programme.placeholder.noSearchName"),clearable:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),a("el-col",{attrs:{span:3}},[a("el-select",{attrs:{placeholder:e.$t("programme.placeholder.noSelect")},model:{value:e.a,callback:function(t){e.a=t},expression:"a"}},e._l([{label:e.$t("programme.searchOption.taskType[0]"),value:""},{label:e.$t("programme.searchOption.taskType[1]"),value:"1"},{label:e.$t("programme.searchOption.taskType[2]"),value:"2"}],function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-col",{attrs:{span:15}},[a("el-button",{attrs:{icon:"el-icon-plus",type:"primary",plain:""},on:{click:e.setType}},[e._v(e._s(e.$t("programme.button.newTask")))]),e._v(" "),a("el-button",{staticStyle:{"margin-right":"10px"},attrs:{icon:"el-icon-download",type:"primary",plain:""},on:{click:e.cc}},[e._v(e._s(e.$t("programme.button.inputTask")))]),e._v(" "),a("el-popconfirm",{attrs:{confirmButtonText:e.multipleSelection.length?e.$t("programme.button.confirmDel.yes"):e.$t("programme.button.confirmDel.ok"),cancelButtonText:e.multipleSelection.length?e.$t("programme.button.confirmDel.no"):"",icon:"el-icon-info",iconColor:"red",title:e.multipleSelection.length?e.$t("programme.tips.confirmSelectDel",{num:e.multipleSelection.length}):e.$t("programme.tips.noSelectDel"),confirmButtonType:"danger"},on:{confirm:e.deleteTask}},[a("el-button",{attrs:{slot:"reference",icon:"el-icon-delete",type:"danger",plain:""},slot:"reference"},[e._v(e._s(e.$t("programme.button.delTask")))])],1)],1)],1),e._v(" "),a("el-row",[a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"max-height":"720px",data:e.tableData.filter(function(t){return(!e.search||t.task_name.toLowerCase().includes(e.search.toLowerCase()))&&(!e.a||t.task_type==e.a)}),"tooltip-effect":"light",border:"",stripe:"","row-key":"task_id"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"40","reserve-selection":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"task_id",label:e.$t("programme.tableTitle.task_id"),sortable:"",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"task_name",label:e.$t("programme.tableTitle.task_name"),"min-width":"130",sortable:"","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"ov-el"},[e._v(e._s(t.row.task_name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"task_type",label:e.$t("programme.tableTitle.task_type"),sortable:"",width:"156"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(1==t.row.task_type?e.$t("programme.taskType[0]"):e.$t("programme.taskType[1]")))]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"file_name",label:e.$t("programme.tableTitle.file_name"),"min-width":"130",sortable:"","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"ov-el"},[e._v(e._s(t.row.file_name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"create_time",label:e.$t("programme.tableTitle.create_time"),sortable:"",width:"160"}}),e._v(" "),a("el-table-column",{attrs:{prop:"update_time",label:e.$t("programme.tableTitle.update_time"),sortable:"",width:"160"}}),e._v(" "),a("el-table-column",{attrs:{prop:"consumed_time",label:e.$t("programme.tableTitle.consumed_time"),sortable:"",width:"166"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.consumed_time?t.row.consumed_time+e.$t("programme.seconds"):"--"))]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"task_status",label:e.$t("programme.tableTitle.task_status"),sortable:"",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:t.row.task_status>0?100*t.row.task_status+"%":t.row.task_status,placement:"top-start"}},[a("el-progress",{class:100*t.row.task_status<20?"black-text":"",attrs:{"text-inside":!0,"stroke-width":26,color:parseInt(t.row.task_status)?"#67C23A":"",status:t.row.task_status>0&&t.row.task_status<100?null:"exception",percentage:e.percentage(t.row.task_status),format:e.format(t.row.task_status)}})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"performance",label:e.$t("programme.tableTitle.performance"),width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},e._l(t.row.performance,function(t,s){return a("div",{key:s,staticClass:"text item"},[e._v(e._s(s)+"："+e._s(t))])}),0)]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"func",label:e.$t("programme.tableTitle.func"),width:"290"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{"text-align":"center"}},[a("el-button-group",[a("el-button",{attrs:{size:"mini",plain:""},on:{click:function(a){return e.editTask(t.$index,t.row)}}},[e._v(e._s(e.$t("programme.button.table.edits")))]),e._v(" "),a("el-button",{attrs:{size:"mini",plain:"",disabled:!parseInt(t.row.task_status)},on:{click:function(a){return e.showDetail(t.$index,t.row)}}},[e._v(e._s(e.$t("programme.button.table.view")))]),e._v(" "),a("el-button",{attrs:{size:"mini",plain:"",disabled:!parseInt(t.row.task_status)},on:{click:function(a){return e.downloader(t.$index,t.row)}}},[e._v(e._s(e.$t("programme.button.table.downloading")))]),e._v(" "),a("el-button",{attrs:{size:"mini",plain:""},on:{click:function(a){return e.exportTask(t.$index,t.row)}}},[e._v(e._s(e.$t("programme.button.table.export")))])],1)],1)]}}])})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:(e.isNew?e.$t("programme.dialogTitle.newTask"):e.$t("programme.dialogTitle.edtTask")+": "+e.curTaskid)+" -- "+((e.isNew?1==e.form.type:1==this.taskType)?e.$t("programme.taskType[0]"):e.$t("programme.taskType[1]")),width:"1200px",visible:e.dialogFormVisible,"close-on-click-modal":!1,"destroy-on-close":!0,"append-to-body":""},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("newProgramme",{ref:"stepBlock",attrs:{currentStep:e.currentStep,curTaskid:e.curTaskid,taskName:e.taskName,taskType:e.taskType},on:{updateStep:e.updateStep}}),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.currentStep>0?a("el-button",{on:{click:function(t){e.currentStep-=1}}},[e._v(e._s(e.$t("programme.button.dialog.pre")))]):e._e(),e._v(" "),a("el-tooltip",{ref:"test",attrs:{content:"Bottom center",placement:"bottom",effect:"light"}}),e._v(" "),e.currentStep<3?a("el-button",{attrs:{type:"primary",title:e.currentStep?"":e.$t("programme.tips.saveStep")},on:{click:e.nextStep}},[e._v(e._s(e.$t("programme.button.dialog.next")))]):e._e(),e._v(" "),3==e.currentStep?a("el-button",{attrs:{type:"primary"},on:{click:e.executeStep}},[e._v(e._s(e.$t("programme.button.dialog.ok")))]):e._e(),e._v(" "),a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v(e._s(e.$t("programme.button.dialog.cancel")))])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.$t("programme.dialogTitle.setTaskType"),visible:e.dialogSetTypeVisible,"close-on-click-modal":!1,"destroy-on-close":!0,"append-to-body":""},on:{"update:visible":function(t){e.dialogSetTypeVisible=t}}},[a("div",[a("el-form",{ref:"setType",staticClass:"step",attrs:{model:e.form,rules:e.rules.setType}},[a("el-form-item",{attrs:{label:e.$t("programme.formLabelName.taskType"),"label-width":"260px",prop:"type"}},[a("el-select",{attrs:{placeholder:e.$t("programme.placeholder.noSelect")},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[a("el-option",{attrs:{label:e.$t("programme.taskType[0]"),value:"1"}}),e._v(" "),a("el-option",{attrs:{label:e.$t("programme.taskType[1]"),value:"2"}})],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.openSetdialog}},[e._v(e._s(e.$t("programme.button.dialog.next")))]),e._v(" "),a("el-button",{on:{click:function(t){e.dialogSetTypeVisible=!1}}},[e._v(e._s(e.$t("programme.button.dialog.cancel")))])],1)]),e._v(" "),a("el-dialog",{attrs:{title:e.$t("programme.dialogTitle.inputTask"),visible:e.dialogUploadConfigVisible,"close-on-click-modal":!1,"destroy-on-close":!1,showClose:!1,"append-to-body":""},on:{"update:visible":function(t){e.dialogUploadConfigVisible=t}}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:0!=e.upNum&&e.doneS+e.doneF!=e.upNum,expression:"upNum!=0&&(doneS+doneF!=upNum)"}]},[a("el-upload",{ref:"upload",attrs:{"file-list":e.fileList,action:this.URL.baseurl+"/upload_config_file","on-progress":e.handleProgress,"on-success":e.handleSuccess,"on-error":e.handleError,multiple:!0,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"on-change":e.handleChange,"auto-upload":!1}},[a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("\n            "+e._s(0!=e.upNum&&e.doneS+e.doneF==e.upNum&&e.$t("programme.tips.upResult1",{doneS:e.doneS,doneF:e.doneF})+(e.doneF?e.$t("programme.tips.upResult2"):"")||"")+"\n          ")])])],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{disabled:0!=e.upNum&&e.doneS+e.doneF!=e.upNum,type:"success",plain:""},on:{click:e.submitUpload}},[e._v(e._s(e.$t("programme.button.upload")))]),e._v(" "),a("el-button",{attrs:{disabled:0!=e.upNum&&e.doneS+e.doneF!=e.upNum},on:{click:e.bb}},[e._v(e._s(e.$t("programme.button.dialog.close")))])],1)]),e._v(" "),a("div",{staticStyle:{display:"none"}},[a("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:0!=e.upNum&&e.doneS+e.doneF!=e.upNum,expression:"upNum!=0&&(doneS+doneF!=upNum)"}],ref:"upload",attrs:{"file-list":e.fileList,action:this.URL.baseurl+"/upload_config_file","on-progress":e.handleProgress,"on-success":e.handleSuccess,"on-error":e.handleError,multiple:!0,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"on-change":e.handleChange,"auto-upload":!1}},[a("el-button",{attrs:{slot:"trigger",id:"main",size:"small",type:"primary",plain:""},on:{click:e.aa},slot:"trigger"},[e._v(e._s(e.$t("programme.button.selectFile")))])],1)],1)],1)},staticRenderFns:[]};var m=a("VU/8")(l,n,!1,function(e){a("uCrL"),a("6NjS")},"data-v-04bffb88",null);t.default=m.exports},uCrL:function(e,t){}});