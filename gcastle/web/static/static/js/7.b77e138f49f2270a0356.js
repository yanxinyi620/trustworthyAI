webpackJsonp([7],{YEa3:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("mvHQ"),i=a.n(s),l={name:"rating",components:{},props:["taskid","dialogRatingVisible"],data:function(){return{checkAll:!1,isIndeterminate:!1,evaluations_list:"",formLabelWidth:"300px",evaluation_list:[],scsz:"1",testloading:!1,checkDis:!1,errText:"",operators:[],selected_parameters:{},form:{chosen_evaluation:[],label_data_path:"",selected_operators:"",selected_parameters:{}},rules:{step1:{chosen_evaluation:[{required:!0,message:this.$t("rating.noRules"),trigger:"blur"}]},step3:{selected_operators:[]}},label_path:""}},watch:{taskid:{deep:!0,handler:function(t,e){var a=this;if(console.log(t+"newV"),console.log(e+"oldV"),this.evaluations_list="",this.scsz="",!t&&0!==t)return!1;this.$http.post(this.URL.baseurl+"/get_label_checkbox",{task_id:this.taskid},{emulateJSON:!0}).then(function(t){console.log("True"==t.body.is_inline),"True"==t.body.is_inline?a.scsz="2":a.scsz="1"}),this.$http.post(this.URL.baseurl+"/get_evaluation_metrics",{task_id:this.taskid},{emulateJSON:!0}).then(function(t){a.evaluation_list=t.body.evaluation_list,a.form.chosen_evaluation=t.body.chosen_evaluation,a.handleCheckedNodeItemChange(a.form.chosen_evaluation)})}},scsz:{deep:!0,handler:function(t,e){2==t?this.getGeneratOperatorList():1==t&&this.getCustomizeLabel()}}},methods:{handleCheckAllChange:function(t){this.form.chosen_evaluation=t?this.evaluation_list:[],this.isIndeterminate=!1},handleCheckedNodeItemChange:function(t){var e=t.length;this.checkAll=e===this.evaluation_list.length,this.isIndeterminate=e>0&&e<this.evaluation_list.length},handleSelect:function(t,e){},goBack:function(){this.$router.go(-1)},scsj:function(){var t=this,e={task_id:this.taskid,selected_operators:this.form.selected_operators,selected_parameters:i()(this.selected_parameters)};this.$http.post(this.URL.baseurl+"/get_generat_label_data",e,{emulateJSON:!0}).then(function(e){200==e.body.status?(console.log("200"),t.label_path=e.body.data.label_path):t.label_path="err"},function(t){})},testPath:function(t,e,a){var s=this;return t?1!=this.scsz?(a(),!1):(this.testloading=!0,this.checkDis=!0,this.errText=this.$t("rating.checking"),void this.$http.post(this.URL.baseurl+"/check_label_dataset",{label_data_path:this.form.label_data_path},{emulateJSON:!0}).then(function(t){200==t.body.status?(console.log("200"),s.errText=t.body.data,a()):(s.errText="",a(new Error(t.body.data))),s.checkDis=!1,s.testloading=!1},function(t){a(new Error("err")),this.checkDis=!1,this.testloading=!1,this.errText=""})):(this.$refs.step2.validateField("label_data_path"),!1)},testBefor:function(){var t=this,e=!1;this.$refs.step1.validate(function(t){e=!!t}),e&&1==this.scsz?this.$refs.step2.validate(function(e){e&&t.evaluationExecute()}):e&&2==this.scsz&&this.$refs.step3.validate(function(e){e&&t.evaluationExecute()})},evaluationExecute:function(){var t=this;this.evaluations_list="";var e={task_id:this.taskid,label_path:1==this.scsz?this.form.label_data_path:this.form.selected_operators,chosen_evaluation:i()(this.form.chosen_evaluation)};this.$http.post(this.URL.baseurl+"/execute_evaluation",e,{emulateJSON:!0}).then(function(e){400==e.body.status?t.$message({message:e.body.data,type:"error"}):(t.evaluations_list=e.body.evaluations,t.$emit("closeDialogRating"))},function(t){this.$message({message:t.body.data||"err",type:"error"})})},getGeneratOperatorList:function(){var t=this;this.taskid&&this.$http.post(this.URL.baseurl+"/get_builtin_label",{task_id:this.taskid},{emulateJSON:!0}).then(function(e){t.operators=e.body.operators,t.form.selected_operators=e.body.selected_operators})},getCustomizeLabel:function(){var t=this;this.$http.post(this.URL.baseurl+"/get_customize_label",{task_id:this.taskid},{emulateJSON:!0}).then(function(e){t.form.label_data_path=e.body.label_data_path})},getAlgorithmParameters:function(){}},created:function(){var t=this;this.evaluations_list="",this.scsz="",this.errText="",this.taskid&&(this.$http.post(this.URL.baseurl+"/get_label_checkbox",{task_id:this.taskid},{emulateJSON:!0}).then(function(e){console.log("True"==e.body.is_inline),"True"==e.body.is_inline?t.scsz="2":t.scsz="1"}),this.$http.post(this.URL.baseurl+"/get_evaluation_metrics",{task_id:this.taskid},{emulateJSON:!0}).then(function(e){t.evaluation_list=e.body.evaluation_list,t.form.chosen_evaluation=e.body.chosen_evaluation,t.handleCheckedNodeItemChange(t.form.chosen_evaluation)}))},activated:function(){},deactivated:function(){this.form={chosen_evaluation:[],label_data_path:"",selected_operators:"",selected_parameters:{}},this.evaluations_list="",this.scsz="",this.errText="",this.$refs.step1.clearValidate(),this.$refs.step2.clearValidate(),this.$refs.step3.clearValidate()}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"rating-main"},[a("el-row",{directives:[{name:"show",rawName:"v-show",value:0,expression:"0"}],staticClass:"title",attrs:{gutter:20}},[a("el-col",{attrs:{span:10}},[a("h3",[t._v(t._s(t.$t("rating.taskid")+t.taskid))])]),t._v(" "),a("el-col",{attrs:{span:14}},[a("div",{staticStyle:{"text-align":"right"}},[a("el-button",{on:{click:t.goBack}},[t._v(t._s(t.$t("rating.button.back")))])],1)])],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v(t._s(t.$t("rating.result")))])]),t._v(" "),t._l(t.evaluations_list,function(e,s){return a("div",{key:s,staticClass:"text item"},[t._v(t._s(s+" : "+(e||"--")))])})],2)],1),t._v(" "),a("div",[a("el-divider",{attrs:{"content-position":"center"}},[t._v(t._s(t.$t("rating.rules")))]),t._v(" "),a("el-form",{ref:"step1",attrs:{model:t.form,rules:t.rules.step1}},[a("el-form-item",{attrs:{label:t.$t("rating.selectRules"),"label-width":t.formLabelWidth,prop:"chosen_evaluation"}},[a("el-checkbox",{attrs:{indeterminate:t.isIndeterminate},on:{change:t.handleCheckAllChange},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}},[t._v(t._s(t.$t("programmeDetail.radio.checkAll")))]),t._v(" "),a("el-checkbox-group",{on:{change:t.handleCheckedNodeItemChange},model:{value:t.form.chosen_evaluation,callback:function(e){t.$set(t.form,"chosen_evaluation",e)},expression:"form.chosen_evaluation"}},t._l(t.evaluation_list,function(t){return a("el-checkbox",{key:t,attrs:{label:t}})}),1)],1)],1)],1),t._v(" "),a("div",[a("el-divider",{attrs:{"content-position":"center"}},[t._v(t._s(t.$t("rating.trueCausal")))]),t._v(" "),a("el-form",[a("el-form-item",{attrs:{label:t.$t("rating.youCan"),"label-width":t.formLabelWidth,rules:[{required:!0,message:t.$t("rating.noType"),trigger:"blur"}]}},[a("el-radio",{attrs:{label:"1"},model:{value:t.scsz,callback:function(e){t.scsz=e},expression:"scsz"}},[t._v(t._s(t.$t("rating.radio.cust")))]),t._v(" "),a("el-radio",{attrs:{label:"2"},model:{value:t.scsz,callback:function(e){t.scsz=e},expression:"scsz"}},[t._v(t._s(t.$t("rating.radio.init")))])],1)],1),t._v(" "),a("el-form",{directives:[{name:"show",rawName:"v-show",value:1==t.scsz,expression:"scsz==1"}],ref:"step2",attrs:{model:t.form,rules:t.rules.step2}},[a("el-form-item",{attrs:{label:t.$t("rating.custCausal"),"label-width":t.formLabelWidth,prop:"label_data_path",rules:[{required:1==t.scsz,message:t.$t("rating.noContent"),trigger:"blur"},{validator:t.testPath,trigger:"blur"}]}},[a("el-input",{attrs:{placeholder:t.$t("rating.noContent")},model:{value:t.form.label_data_path,callback:function(e){t.$set(t.form,"label_data_path",e)},expression:"form.label_data_path"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search",loading:t.testloading,disabled:t.checkDis},on:{click:function(e){return t.testPath()}},slot:"append"},[t._v(t._s(t.$t("rating.button.check")))])],1),t._v(" "),a("div",{staticClass:"sub-title",domProps:{textContent:t._s(t.errText)}})],1)],1),t._v(" "),a("el-form",{directives:[{name:"show",rawName:"v-show",value:2==t.scsz,expression:"scsz==2"}],ref:"step3",attrs:{model:t.form,rules:t.rules.step3}},[a("el-form-item",{attrs:{label:t.$t("rating.initCausal"),"label-width":t.formLabelWidth,prop:"selected_operators",rules:[{required:2==t.scsz,message:t.$t("rating.noDataset"),trigger:"blur"}]}},[a("el-select",{attrs:{placeholder:t.$t("rating.noDataset")},on:{change:t.getAlgorithmParameters},model:{value:t.form.selected_operators,callback:function(e){t.$set(t.form,"selected_operators",e)},expression:"form.selected_operators"}},t._l(t.operators,function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})}),1)],1),t._v(" "),t._l(t.selected_parameters,function(e,s){return a("el-form-item",{key:s,attrs:{label:s,"label-width":t.formLabelWidth}},[a("el-input",{attrs:{placeholder:e},model:{value:t.form.selected_parameters[s],callback:function(e){t.$set(t.form.selected_parameters,s,e)},expression:"form.selected_parameters[key]"}})],1)}),t._v(" "),a("el-form-item",{staticClass:"cc"},[a("div",[t._v(t._s(t.label_path))])])],2)],1),t._v(" "),a("el-form",[a("el-form-item",{staticClass:"cc"})],1)],1)},staticRenderFns:[]};var r=a("VU/8")(l,o,!1,function(t){a("kLuH")},"data-v-58aaf9c4",null);e.default=r.exports},kLuH:function(t,e){}});